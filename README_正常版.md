# 🌌 星尘挽歌引擎

## 🚀 项目概述

星尘挽歌引擎是一个模拟极端重力环境下虚空宇宙行为的物理引擎。在这个独特的宇宙模型中，不存在传统意义上的天体，取而代之的是作为引力源的“星核”（Stellar Pearl）和在其中运动的单一实体“星翎”（Celestial Plume）。

## ✨ 核心概念与参数

### 1. 宇宙基本法则

*   **引力常数 (G)**：
    *   `G = 0.1` (模拟值)
    *   代表一个极高的引力强度，远超常规宇宙，导致空间行为显著扭曲。
*   **虚空环境**：
    *   模拟空间中无传统恒星、行星等天体。
    *   “星核”是唯一的引力源和可视发光点。
*   **边界速度衰减因子 (BoundaryDecayFactor)**:
    *   `BoundaryDecayFactor = 0.6` (默认值，可配置)
    *   当星翎触及任何边界条件（镜渊之门或虹光回音壁）时，其速度将立即衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。

### 2. 关键实体

*   **星核 (Stellar Pearl)**：
    *   **描述**：模拟空间中的点状引力源。
    *   **属性**：
        *   默认质量：`50KG`。
        *   数量可配置：可在虚空中设置任意数量的星核。
    *   **状态与行为**：
        *   **激活态 (Active)**：星核正常产生引力。
        *   **沉寂态 (Inactive)**：当星翎接触到星核时，该星核会立即进入沉寂态，其引力作用暂时消失。
        *   **恢复**：沉寂态的星核会随时间（或模拟步长）积累到一定程度时恢复到激活态。
*   **星翎 (Celestial Plume)**：
    *   **描述**：模拟空间中唯一的、受星核引力影响而运动的实体。
    *   **行为**：
        *   **运动**：其轨迹由星核群的引力与自身动力共同决定。
        *   **自身推进**：星翎具备独立推进能力，可调整其方向和速度。
        *   **接触效应**：当星翎与星核接触的瞬间，星翎会爆发一次短暂且强烈的闪光，同时被接触的星核进入沉寂态。

### 3. 边界条件

*   **镜渊之门 (Mirror Abyss)**：
    *   **描述**：模拟空间的边界区域。当星翎触及此边界时，触发特定穿越行为。
    *   **模式**：
        *   **模式一：镜像穿越 (Mirror Traversal)**：星翎触及边界后，其位置会被瞬间映射到镜像的对向区域（相对于原点），并反转运动方向，同时速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。
        *   **模式二：随机穿越 (Random Traversal)**：星翎触及边界后，会在边界上的任意一点重新出现，并自动调整方向朝向宇宙中心点，同时速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。
*   **虹光回音壁 (Rainbow Light Wall)**：
    *   **描述**：模拟空间的边缘。当星翎触及此壁时，触发反射行为。
    *   **入射角度范围**：`[0, π/2)` (弧度)。
    *   **模式**：
        *   **模式一：镜面反射 (Specular Reflection)**：当星翎以任意入射角触及边界时，其反射方向将严格遵循物理的镜面反射定律（入射角等于反射角），同时速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。
        *   **模式二：漫反射 (Diffuse Reflection)**：当星翎以入射角大于 0 且小于 π/2 触及边界时，其反射方向将在一个预设的反射角度范围内随机分布，同时速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。

## ⚙️ 引擎工作原理

### 1. 引力计算模块 (Gravity Loom)

*   **功能**：在每个模拟时间步长内，计算所有激活状态的星核对星翎的引力作用。
*   **法则**：遵循特定物理法则（如最小作用原理）来更新星翎的运动状态。

### 2. 边界管理模块 (Boundary Atrium)

*   **功能**：处理星翎与模拟空间边界的交互。
*   **边界效应**：检测星翎是否触及边界，并根据当前配置的镜渊之门或虹光回音壁模式执行相应的空间变换或反射逻辑。

### 3. 模拟步进器 (Orbital Loom)

*   **功能**：驱动整个宇宙模拟的迭代过程。
*   **数据记录**：记录星翎在三维空间中的位置。
*   **状态更新**：
    ```mermaid
    graph LR
      A[星翎当前位置] --> B[星翎当前速度]
      B --> C{是否与激活星核接触?}
      C -->|是| D[星翎爆发闪光]
      D --> E[被接触星核进入沉寂态]
      C -->|否| F[更新星翎位置与速度 (考虑引力与自身动力)]
      E --> G[被接触星核开始恢复计时]
      F --> H[检查并更新所有沉寂星核的恢复状态]
      H --> I[下一模拟步]
    ```

## 🛠️ API / 配置接口 (星枢庭园)

以下是引擎提供的主要配置和操作接口：

| 操作名称           | 功能描述                                   |
| ------------------ | ------------------------------------------ |
| **调谐星律**       | 设置全局引力常数 `G` 的数值。              |
| **编织星穹**       | 在指定位置添加新的星核。                   |
| **抚育星核**       | 配置或修改特定星核的质量。                 |
| **引航星翎**       | 设置星翎的初始位置和初始速度。             |
| **控制星翎动力**   | 实时调整星翎的推进方向和速度。             |
| **配置镜渊模式**   | 设置镜渊之门的穿越模式（镜像或随机）。     |
| **配置虹光模式**   | 设置虹光回音壁的反射模式（镜面或漫反射）。 |
| **配置边界衰减**   | 设置 `BoundaryDecayFactor` 的数值。        |
| **流转星轨**       | 推动模拟前进一个时间步长。                 |

### 星核状态管理 (相位之舞)

*   **接触事件**：当星翎与星核接触时：
    1.  **闪光与沉寂**：星翎瞬间发出亮光，被接触的星核立即切换到沉寂态（引力作用消失）。
    2.  **逐步恢复**：沉寂的星核会随着后续的模拟步长，积累到一定程度后恢复其引力作用。

## 📝 模拟案例 (宇宙叙事片段)

### 1. 镜渊穿越示例

*   **场景**：星翎 "琉璃羽" 位于西象限，向中心移动，最终触及虚空边界。
*   **结果示例**：
    *   **模式：镜像穿越**：星翎触及虚空边界后，其位置瞬息映射至宇宙中心对侧的镜像区域，并反转运动方向，速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍，并继续受远处星核 "夜歌" 的引力影响。
    *   **模式：随机穿越**：星翎触及虚空边界后，骤然在边界上的任意一点（例如：北边界的随机点）重新出现，并调整方向朝向宇宙中心，速度衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍，继续其旅程。

### 2. 虹光反射示例

*   **场景**：星翎 "银梭" 向虹光回音壁运动。
*   **结果示例**：
    *   **模式：镜面反射 (入射角为 π/4)**：星翎以 45 度角（π/4 弧度）撞向壁面，然后以相同的 45 度角反射出去，其速度将衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。
    *   **模式：漫反射 (入射角为 π/4)**：星翎以 45 度角撞向壁面，其反射方向将在一个预设的反射角度范围内（例如：从垂直壁面到与壁面平行之间）随机选择一个方向继续运动，其速度将衰减至原速度的 `(1 - BoundaryDecayFactor)` 倍。

### 3. 星核接触示例

*   **场景**：星翎 "晨曦" 运动并接触到星核 "幽蓝之心"。
*   **结果**：星翎 "晨曦" 瞬间爆发一道耀眼的光芒，随后恢复正常。星核 "幽蓝之心" 的引力立即消失，进入沉寂态，并在接下来的模拟步长中逐渐恢复其引力作用。

---